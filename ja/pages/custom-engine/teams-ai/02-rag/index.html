
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/copilot-camp/ja/pages/custom-engine/teams-ai/02-rag/">
      
      
        <link rel="prev" href="../01-custom-engine-agent/">
      
      
        <link rel="next" href="../03-powered-by-ai/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>ラボ BTA2 - Azure AI Search にデータをインデックス化 - Copilot Developer Camp</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/labStyles.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bta2-azure-ai-search" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../../../../" title="Copilot Developer Camp" class="md-header__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../../assets/images/tent-small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Copilot Developer Camp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ラボ BTA2 - Azure AI Search にデータをインデックス化
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="言語切り替え">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../../../pages/custom-engine/teams-ai/02-rag/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="ja" class="md-select__link">
              Japanese (日本語)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/copilot-camp" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../" class="md-tabs__link">
        
  
  
    
  
  ようこそ

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../make/" class="md-tabs__link">
          
  
  
  Maker 向けエージェントの作成

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../extend-m365-copilot/" class="md-tabs__link">
          
  
  
  宣言型エージェントの構築

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  カスタム エンジン エージェントの構築

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../copilot-instructions/beginner-agent/" class="md-tabs__link">
          
  
  
  プロンプト エンジニアリング

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../awards/" class="md-tabs__link">
        
  
  
    
  
  アワード

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../resources/" class="md-tabs__link">
        
  
  
    
  
  動画など

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../" title="Copilot Developer Camp" class="md-nav__button md-logo" aria-label="Copilot Developer Camp" data-md-component="logo">
      
  <img src="../../../../../assets/images/tent-small.png" alt="logo">

    </a>
    Copilot Developer Camp
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/copilot-camp" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ようこそ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Maker 向けエージェントの作成
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Maker 向けエージェントの作成
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft 365 Copilot 用エージェントの作成
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/agent-builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MAB - Copilot Studio agent builder でエージェントを作成
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/agent-builder/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab MAB1 - はじめてのエージェント構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/copilot-studio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS - Microsoft Copilot Studio の概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/copilot-studio/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS0 - セットアップ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/copilot-studio/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS1 - 最初のエージェント
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/copilot-studio/02-topics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS2 - トピックの定義
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/copilot-studio/03-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS3 - ツールの定義
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/copilot-studio/04-extending-m365-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS4 - Microsoft 365 Copilot の拡張
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/copilot-studio/05-connectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MCS5 - Power Platform カスタム コネクタ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/sharepoint-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MSA - SharePoint エージェントの概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/sharepoint-agents/01-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MSA1 - 最初の SharePoint エージェントの構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../make/sharepoint-agents/02-sharing-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MSA2 - SharePoint エージェントの共有
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    宣言型エージェントの構築
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            宣言型エージェントの構築
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft 365 Copilot の拡張
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    セットアップ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            セットアップ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E0 - セットアップ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    宣言型エージェントの基礎
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            宣言型エージェントの基礎
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/01-typespec-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E1 - Microsoft 365 Agents Toolkit で TypeSpec 定義を使用して最初の Declarative エージェントを構築する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/01a-geolocator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E1 - インストラクション ベースの Gelocator ゲーム エージェント
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API をゼロから構築して統合
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            API をゼロから構築して統合
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/02-build-the-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab E2 - API を構築する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/03-add-declarative-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E3 - 宣言型エージェントと API プラグインの追加
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/04-enhance-api-plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E4 - API とプラグインの拡張
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/05-add-adaptive-card/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E5 - Adaptive Card の追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    認証
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            認証
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/06a-add-authentication-ttk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E6a - OAuth を使用した Entra ID 認証の追加 (Agents Toolkit)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/06b-add-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E6b - OAuth を使用した Entra ID 認証（手動セットアップ）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/06c-add-sso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E6c - Entra ID 認証とシングル サインオンの追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    インテグレーション
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            インテグレーション
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extend-m365-copilot/07-add-graphconnector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ E7 ‑ 統合: Microsoft Copilot Connector を使用した Trey Genie への Knowledge 機能の追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    カスタム エンジン エージェントの構築
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            カスタム エンジン エージェントの構築
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    カスタム エンジン エージェントの構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    M365 Agents SDK ラボ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            M365 Agents SDK ラボ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    イントロ - M365 Agents SDK と Semantic Kernel で独自エージェントを構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents-sdk/00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab BMA0 - 前提条件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents-sdk/01-agent-in-foundry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BMA1 - Azure AI Foundry でエージェントを準備する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents-sdk/02-agent-with-agents-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BMA2 - M365 Agents SDK を使用した初めてのエージェント構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents-sdk/03-agent-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BMA3 - Azure AI Foundry エージェントと M365 Agents SDK の統合
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents-sdk/04-bring-agent-to-copilot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ MBA4 - エージェントを Copilot Chat へ接続
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Teams AI library ラボ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Teams AI library ラボ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    イントロ - Teams AI ライブラリで独自のエージェントを構築
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA0 - 前提条件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-custom-engine-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA1 - Teams AI ライブラリによる最初のカスタムエンジン エージェント
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    ラボ BTA2 - Azure AI Search にデータをインデックス化
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA2 - Azure AI Search にデータをインデックス化
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      はじめに
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-azure" class="md-nav__link">
    <span class="md-ellipsis">
      演習 1: Azure リソースをセットアップする
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-azure-ai-foundry-chat-playground-azure-ai-search" class="md-nav__link">
    <span class="md-ellipsis">
      演習 2: Azure AI Foundry Chat Playground を使用してドキュメントを Azure AI Search にアップロードする
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-azure-ai-search_1" class="md-nav__link">
    <span class="md-ellipsis">
      演習 3: アプリを Azure AI Search と統合する
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-powered-by-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA3 - ユーザー エクスペリエンスの強化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA4 - シングル サインオン認証の追加
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ラボ BTA5 - 複雑なタスクを処理するアクションの追加
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    プロンプト エンジニアリング
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            プロンプト エンジニアリング
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../copilot-instructions/beginner-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    エージェント インストラクション ラボ ― 初心者向けエージェント指示の改善
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../awards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    アワード
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    動画など
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="bta2-azure-ai-search">ラボ BTA2 - Azure AI Search にデータをインデックス化</h1>
<p>このラボでは、カスタム エンジン エージェントで Retrieval ‑ Augmented Generation を有効にし、Azure AI Search と統合して自分のデータとチャットできるようにします。</p>
<p>このラボで行うこと:</p>
<ul>
<li>Retrieval ‑ Augmented Generation (RAG) とは何かを学ぶ  </li>
<li>Azure リソースをセットアップする  </li>
<li>ドキュメントを Azure AI Search にアップロードする  </li>
<li>カスタム エンジン エージェントを Vector Search 用に準備する  </li>
<li>アプリの実行方法とテスト方法を学ぶ  </li>
</ul>
<div class="lab-intro-video">
    <div style="flex: 1; min-width: 0;">
        <iframe  src="//www.youtube.com/embed/J7IZULJsagM" frameborder="0" allowfullscreen style="width: 100%; aspect-ratio: 16/9;">          
        </iframe>
          <div>このビデオでラボの概要を素早く確認しましょう。</div>
    </div>
    <div style="flex: 1; min-width: 0;">
        <div class="floatwide">
        <div class="cc-lab-toc b-path">
          <img src="/copilot-camp/assets/images/path-icons/B-path-heading.png"></img>
          <div>
            <p>Azure OpenAI と Teams AI ライブラリを使用してカスタム AI モデルとオーケストレーションを備えた Custom engine エージェントを構築したい場合は、これらのラボを実施してください。</p>
            <ul>
              <li><a href="/copilot-camp/ja/pages/custom-engine/teams-ai/00-prerequisites/">BTA0 - セットアップ</a></li>
              <li><a href="/copilot-camp/ja/pages/custom-engine/teams-ai/01-custom-engine-agent/">BTA1 - はじめての Custom engine エージェント</a></li>
              <li><a href="/copilot-camp/ja/pages/custom-engine/teams-ai/02-rag/">BTA2 - データを Azure AI Search にインデックスする</a></li>
              <li><a href="/copilot-camp/ja/pages/custom-engine/teams-ai/03-powered-by-ai/">BTA3 - ユーザー エクスペリエンスを向上させる</a></li>
              <li><a href="/copilot-camp/ja/pages/custom-engine/teams-ai/04-authentication/">BTA4 - シングル サインオン認証を追加する</a></li>
              <li><a href="/copilot-camp/ja/pages/custom-engine/teams-ai/05-actions/">BTA5 - 複雑なタスクを処理する actions を追加する</a></li>
            </ul>
          </div>
        </div>

        <script>
        (() => {
        // This script decorates the table of contents with a "you are here" indicator.
        const toc = document.getElementsByClassName('cc-lab-toc');
        for (const div of toc) {
            const lis = div.querySelectorAll('li');
            for (const li of lis) {
                const anchor = li.querySelector('a');
                if (location.href.includes(anchor.href)) {
                    const span = document.createElement("span");
                    span.innerHTML = "YOU&nbsp;ARE&nbsp;HERE";
                    li.appendChild(span);
                }
            }    
        }
        })();
        </script>

        <!-- <div class="cc-b-lab-steps">
            <h4>Table of Contents</h4>
            <cc-table-of-contents />
          </div> -->
        </div>
    </div>
</div>

<h2 id="_1">はじめに</h2>
<p>前の演習では、カスタム エンジン エージェントを作成し、AI チャットボット「Career Genie」の動作を定義するプロンプトをカスタマイズしました。本演習では、ベクトル検索を履歴書のコレクションに適用し、職務要件に最適な候補者を探します。Career Genie でベクトル検索を有効にするために、「Azure AI Foundry on your data」機能を利用して次を行います。</p>
<ul>
<li>Azure AI Search にインデックスを作成する  </li>
<li>履歴書 (PDF ドキュメント) のベクトル埋め込みを生成する  </li>
<li>データをチャンクに分割して Azure AI Search にアップロードする  </li>
</ul>
<p>最後に、カスタム エンジン エージェントを Azure AI Search と統合し、自分のデータとチャットして最適な結果を得られるようにします。</p>
<details class="info" open="open">
<summary>Retrieval-Augmented Generation (RAG) とは？</summary>
<p>Retrieval-Augmented Generation (RAG) は、言語モデルが生成する応答の品質を向上させる AI の手法です。簡単な例で説明しましょう。</p>
<p>スマート アシスタントがあなたの質問に答えを作成するとします。時には、このアシスタントが優れた回答をするための十分な情報を持っていない場合があります。そこで RAG を使うと、アシスタントは膨大なドキュメント、ビデオ、画像などからインターネット検索のように情報を探し出し、それを基により正確な回答を作成できます。</p>
<p>RAG は 2 つのステップを組み合わせています。</p>
<ul>
<li><strong>Retrieval:</strong> 大量データから関連情報を検索する  </li>
<li><strong>Generation:</strong> その情報を活用して詳細で正確な応答を生成する  </li>
</ul>
<p>これにより RAG は、質問応答、記事執筆、リサーチ支援などで、より有用で情報量の多い回答を提供できるようになります。</p>
<p><em>RAG について詳しくは、この「Doodle to Code」ビデオをご覧ください！</em></p>
<p><iframe src="//www.youtube.com/embed/1k4XGgsqfTM?si=P6O9baroreDKizb" frameborder="0" allowfullscreen></iframe></p>
</details>
<details class="tip">
<summary>Vector Search を利用する利点</summary>
<p>Vector search は、単なるキーワードの一致ではなく「意味」に基づいて素早く正確に情報を見つける高度な検索技術です。テキストベース検索が正確なキーワード一致に頼るのに対し、vector search は数値ベクトルを使用してクエリと意味的に近いコンテンツを探します。これにより次のような検索が可能になります。</p>
<ul>
<li><strong>意味・概念の類似:</strong> 異なる語でも意味が近い概念をマッチング (例: “pastry” と “croissant”)  </li>
<li><strong>多言語コンテンツ:</strong> 異なる言語間で同等の内容を検索 (例: 英語の “pastry” とドイツ語の “gebäck”)  </li>
<li><strong>多様なコンテンツ形式:</strong> テキスト以外の形式も横断して検索 (例: “pastry” のテキストと、ペストリーの画像)  </li>
</ul>
<p>vector search の仕組み:</p>
<ol>
<li><strong>テキストをベクトルに変換:</strong> 単語や文を意味を捉える数値の並び (ベクトル) に変換 (Word Embeddings や Deep Learning モデルを使用)  </li>
<li><strong>ベクトルを保存:</strong> これらのベクトルは専用のデータベースに保存  </li>
<li><strong>ベクトルで検索:</strong> クエリもベクトル化し、意味的に近いベクトルをデータベースから検索  </li>
</ol>
<p>例えば “how to bake a cake” と検索すると、文中に同一の語がなくても “cake recipes” や “baking tips” の文書を見つけられ、さらに別言語のレシピでもヒットします。大規模データセットでコンテキストと意味に基づく検索が可能になる点が vector search の強みです。</p>
<p>要約すると、vector search は言葉の背後にある意味に着目して検索プロセスを改善し、より的確で関連性の高い結果を提供します。</p>
</details>
<h2 id="1-azure">演習 1: Azure リソースをセットアップする</h2>
<p>この演習を始める前に、<a href="../00-prerequisites/#exercise-3-get-an-azure-subscription" target="_blank">Azure サブスクリプションの前提条件</a> を完了しておく必要があります。</p>
<h3 id="1-azure-ai-search">手順 1: Azure AI Search サービス リソースを作成する</h3>
<details class="check">
<summary>Azure AI Search とは？</summary>
<p>Azure AI Search (旧称 “Azure Cognitive Search”) は、ユーザー所有のコンテンツに対してセキュアかつスケール可能な情報検索を提供し、従来型および生成 AI 検索アプリケーションで利用できます。検索サービスを作成すると、次の機能を利用できます。</p>
<ul>
<li>ベクトル検索、フルテキスト検索、ハイブリッド検索用の検索エンジン  </li>
<li>統合データチャンク化とベクトル化を備えた高度なインデックス作成  </li>
<li>ベクトルクエリ、テキスト検索、ハイブリッドクエリ向けのリッチなクエリ構文  </li>
<li>Azure AI services および Azure OpenAI との統合  </li>
</ul>
</details>
<ol>
<li>任意のブラウザーで <a href="https://portal.azure.com" target="_blank">Azure Portal</a> を開きます。  </li>
<li><strong>Create a resource</strong> を選択し、<code>Azure AI Search</code> を検索します。Azure AI Search サービスを選択し、<strong>Create</strong> をクリックします。  </li>
<li>次の情報を入力し、<strong>Review + Create</strong> を選択します。  <ul>
<li><strong>Subscription:</strong> Azure AI Search サービス用の Azure サブスクリプション  </li>
<li><strong>Resource group:</strong> 以前に Azure OpenAI サービス用に作成したリソース グループ  </li>
<li><strong>Name:</strong> <code>copilotcamp-ai-search</code> などわかりやすい名前  </li>
<li><strong>Location:</strong> インスタンスのリージョン  </li>
<li><strong>Pricing Tier:</strong> Basic  </li>
</ul>
</li>
</ol>
<p>リソースの作成が完了したら、リソースに移動し <strong>Overview</strong> で <code>Url</code> をコピーして保存します。その後 <strong>Settings</strong> 内の <strong>Keys</strong> タブに移動し <code>Primary admin key</code> をコピーして保存します。これらは後続の演習で使用します。</p>
<p><cc-end-step lab="bta2" exercise="1" step="1" /></p>
<h3 id="2-storage-account">手順 2: Storage Account サービス リソースを作成する</h3>
<ol>
<li>任意のブラウザーで <a href="https://portal.azure.com" target="_blank">Azure Portal</a> を開きます。  </li>
<li><strong>Create a resource</strong> を選択し、<code>Storage Account</code> を検索します。Storage Account サービスを選択し、<strong>Create</strong> をクリックします。  </li>
<li>次の情報を入力し、<strong>Review</strong>、続いて <strong>Create</strong> を選択します。  <ul>
<li><strong>Subscription:</strong> Azure Storage Account サービス用の Azure サブスクリプション  </li>
<li><strong>Resource group:</strong> 以前に Azure OpenAI サービス用に作成したリソース グループ  </li>
<li><strong>Name:</strong> <code>copilotcampstorage</code> などわかりやすい名前  </li>
<li><strong>Region:</strong> インスタンスのリージョン  </li>
<li><strong>Performance:</strong> Standard  </li>
<li><strong>Redundancy:</strong> Geo-redundant storage (GRS)  </li>
</ul>
</li>
</ol>
<p><cc-end-step lab="bta2" exercise="1" step="2" /></p>
<h3 id="3-text-embedding-ada-002">手順 3: <code>text-embedding-ada-002</code> モデルを作成する</h3>
<details class="info">
<summary><code>text-embedding-ada-002</code> の役割</summary>
<p>Azure OpenAI の <code>text-embedding-ada-002</code> モデルは、テキストを数値ベクトルに変換し、その意味を表現します。これにより、キーワードの一致ではなく意味の類似性に基づくベクトル検索が可能になります。多言語や異なるコンテンツ形式にも対応しており、言語や形式を越えてテキストを比較できます。Azure AI Search と組み合わせることで、より関連性の高い検索結果を提供できます。自然言語を理解する高度な検索ソリューションやアプリケーションに最適です。</p>
</details>
<p>ブラウザーで <a href="https://oai.azure.com/portal" target="_blank">Azure AI Foundry</a> を開き、<strong>Deployments</strong> を選択します。<strong>Create a new deployment</strong> をクリックし、次を入力して <strong>Create</strong> を選択します。</p>
<ul>
<li><strong>Select a model:</strong> <code>text-embedding-ada-002</code>  </li>
<li><strong>Model version:</strong> Default  </li>
<li><strong>Deployment type:</strong> Standard  </li>
<li><strong>Deployment name:</strong> <code>text-embeddings</code> など覚えやすい名前  </li>
<li><strong>Content Filter:</strong> Default  </li>
</ul>
<div class="admonition tip">
<p class="admonition-title">クォータ不足メッセージへの対処</p>
<p>モデル選択時に <strong>No quota available</strong> のメッセージが表示される場合があります。次のいずれかで対処してください。<br />
1. 別のバージョンまたは Deployment type を選択する<br />
2. <a href="https://oai.azure.com/portal/96d4a6668daf4335bc1273c1bb46cb4f/quota" target="_blank">クォータを増やすか既存クォータを調整</a> してリソースを確保する  </p>
</div>
<p><cc-end-step lab="bta2" exercise="1" step="3" /></p>
<h2 id="2-azure-ai-foundry-chat-playground-azure-ai-search">演習 2: Azure AI Foundry Chat Playground を使用してドキュメントを Azure AI Search にアップロードする</h2>
<p><a href="https://github.com/microsoft/copilot-camp/raw/main/src/custom-engine-agent/Lab02-RAG/CareerGenie/fictitious_resumes.zip">fictitious_resumes.zip</a> をダウンロードして解凍しておいてください。</p>
<h3 id="1-azure-ai-search_1">手順 1: ドキュメントを Azure AI Search にアップロードする</h3>
<ol>
<li>
<p>ブラウザーで <a href="https://oai.azure.com/portal" target="_blank">Azure AI Foundry</a> を開き、<strong>Chat</strong> Playground を選択します。<strong>Setup</strong> セクションで <strong>Reset</strong> をクリックし、システムプロンプトおよび Shakespearean 関連の例を削除して初期状態に戻します。すでに空の状態であれば次へ進んでください。</p>
<p><img alt="The Setup section of the Chat Playground in Azure AI Foundry with the commands to reset the content of the system prompt and of the user prompt highlighted." src="../../../../../assets/images/custom-engine-02/reset-chat-playground.png" /></p>
</li>
<li>
<p><strong>Add your data</strong> を選択し、次に <strong>Add a data source</strong> をクリックします。</p>
<p><img alt="The UI of Azure AI Foundry with the 'Add a data source' command highlighted in the Setup section, to upload custom data sources for the current model in the Chat Playground." src="../../../../../assets/images/custom-engine-02/add-your-data-aoai.png" /></p>
</li>
<li>
<p><strong>Upload files (preview)</strong> を選択し、次を入力して <strong>Next</strong> をクリックします。</p>
<ul>
<li><strong>Subscription:</strong> Azure リソースを作成したサブスクリプション  </li>
<li><strong>Select Azure Blob storage resource:</strong> <code>copilotcampstorage</code> を選択 (アクセス許可が必要な場合は <strong>Turn on CORS</strong> を選択)  </li>
<li><strong>Select Azure AI Search resource:</strong> <code>copilotcamp-ai-search</code> を選択  </li>
<li><strong>Enter the index name:</strong> <code>resumes</code> などのインデックス名 (後で使用するのでメモしておく)  </li>
<li><strong>Add vector search to this search resource</strong> にチェックを入れる  </li>
<li><strong>Select an embedding model:</strong> <code>text-embeddings</code> を選択  </li>
</ul>
</li>
</ol>
<p>インデックス名は後で <code>INDEX_NAME</code> 環境変数に設定するので控えておきます。</p>
<p><img alt="The UI to add a custom data source with fields to select subscription, Azure Storage, Azure AI Search, index name, and embedding model." src="../../../../../assets/images/custom-engine-02/add-data-source-aoai.png" /></p>
<ol>
<li><strong>Browse for a file</strong> をクリックし、<code>resumes</code> フォルダーの pdf を選択します。その後 <strong>Upload files</strong>、<strong>Next</strong> をクリックします。  </li>
<li>Search type を <code>Vector</code>、chunk size を <code>1024 (Default)</code> に設定し <strong>Next</strong> をクリックします。  </li>
<li>Azure resource authentication type として <code>API Key</code> を選択し、<strong>Next</strong> をクリックします。  </li>
</ol>
<p>データ取り込みには数分かかります。準備が完了したらテストに進みます。</p>
<p><cc-end-step lab="bta2" exercise="2" step="1" /></p>
<div class="admonition note">
<p class="admonition-title">注意</p>
<p>一度データをインデックス化すると、Chat Playground を閉じたり更新したりしてもインデックスは Azure AI Search に残ります。Chat Playground がリセットされ「Add your data」を再度行う場合でも、既存インデックスを選択すれば再アップロードは不要です。</p>
</div>
<h3 id="2-azure-ai-foundry">手順 2: Azure AI Foundry でデータをテストする</h3>
<p>データ取り込みが完了したら、Chat Playground で質問してみましょう。  </p>
<p>例: <em>「スペイン語が話せて .NET の経験が少なくとも 2 年ある候補者を提案してもらえますか？」</em></p>
<div class="admonition tip">
<p class="admonition-title">データを最大限活用するヒント</p>
<p>ベクトル検索を試す前に <code>resumes</code> フォルダーを確認し、さまざまな言語、職種、経験年数、スキルが含まれていることを把握しましょう。スキルや言語、職種、経験年数などを組み合わせて質問し、検索体験を試してみてください。</p>
</div>
<p><img alt="The Chat Playground in Azure AI Foundry once custom data has been processed. On the left side, in the Setup section, there is the configuration of the Azure AI Search service as a custom data source. On the right side, in the chat there is a sample prompt with a detailed answer based on the processed documents." src="../../../../../assets/images/custom-engine-02/chat-with-your-data-aoai.png" /></p>
<p><cc-end-step lab="bta2" exercise="2" step="2" /></p>
<h3 id="3-azure-ai-search">手順 3: Azure AI Search でインデックスを覗いてみる</h3>
<p>データセットをさらに理解するため、Chat Playground の <strong>Add your data</strong> セクションで <strong>resumes</strong> を選択します。Azure AI Search の <code>resumes</code> インデックス ページにリダイレクトされます。</p>
<p><img alt="The image highlights the link to the index in Azure AI Search configured in the Setup section of the Chat Playground in Azure AI Foundry" src="../../../../../assets/images/custom-engine-02/index-aoai.png" /></p>
<p>まず、ベクトル コンテンツを含める設定をします。<code>Resumes</code> インデックス ページで <strong>Fields</strong> タブを開き、<strong>contentVector</strong> のチェック ボックスをオンにして <strong>Save</strong> を選択します。</p>
<p><img alt="The UI of Azure AI Search when adding the contentVector field to the search index with the fields tab, the contentVector field, and the save button highlighted." src="../../../../../assets/images/custom-engine-02/add-contentvector.png" /></p>
<p><strong>Search explorer</strong> タブに戻り、<code>Resumes</code> インデックス ページで <strong>Query options</strong> を選択し、<strong>API version</strong> を <code>2024-11-01-preview</code> に変更して <strong>Close</strong> をクリックします。<strong>Search</strong> を押してデータを確認します。</p>
<div class="admonition tip">
<p class="admonition-title"><code>contentVector</code> パラメーターを確認</p>
<p>データをスクロールすると、各ドキュメントに <code>contentVector</code> パラメーターがあることが分かります。これは PDF ドキュメントの数値ベクトルで、ベクトル検索で最適なマッチングを行うために使用されます。</p>
</div>
<p><img alt="The Search Explorer for the current index in Azure AI Search, showing search data with the contentVector field highlighted with the numeric vectors values." src="../../../../../assets/images/custom-engine-02/contentvector-in-your-data.png" /></p>
<p><cc-end-step lab="bta2" exercise="2" step="3" /></p>
<h2 id="3-azure-ai-search_1">演習 3: アプリを Azure AI Search と統合する</h2>
<p>この演習では、Azure OpenAI のテキスト埋め込みデプロイ名と Azure AI Search のキーおよびエンドポイントを取得しておいてください。</p>
<h3 id="1">手順 1: 環境変数を設定する</h3>
<p>Career Genie プロジェクトで <code>env/.env.local.user</code> を開き、次の環境変数を貼り付けます。</p>
<pre><code class="language-json">AZURE_OPENAI_EMBEDDING_DEPLOYMENT_NAME='&lt;Your-Text-Embedding-Model-Name&gt;'
SECRET_AZURE_SEARCH_KEY='&lt;Your-Azure-AI-Search-Key&gt;'
AZURE_SEARCH_ENDPOINT='&lt;Your-Azure-AI-Search-Endpoint&gt;'
INDEX_NAME='&lt;Your-index-name&gt;'
</code></pre>
<p><code>teamsapp.local.yml</code> を開き、<code>uses: file/createOrUpdateEnvironmentFile</code> の下に次のスニペットを追加します。</p>
<pre><code class="language-yml">AZURE_OPENAI_EMBEDDING_DEPLOYMENT_NAME: ${{AZURE_OPENAI_EMBEDDING_DEPLOYMENT_NAME}}
AZURE_SEARCH_KEY: ${{SECRET_AZURE_SEARCH_KEY}}
AZURE_SEARCH_ENDPOINT: ${{AZURE_SEARCH_ENDPOINT}}
INDEX_NAME: ${{INDEX_NAME}}
</code></pre>
<p><code>src/config.ts</code> に移動し、<code>config</code> の中に次のスニペットを追加します。</p>
<pre><code class="language-typescript">azureOpenAIEmbeddingDeploymentName: process.env.AZURE_OPENAI_EMBEDDING_DEPLOYMENT_NAME,
azureSearchKey: process.env.AZURE_SEARCH_KEY,
azureSearchEndpoint: process.env.AZURE_SEARCH_ENDPOINT,
indexName: process.env.INDEX_NAME,
</code></pre>
<p><cc-end-step lab="bta2" exercise="3" step="1" /></p>
<h3 id="2-azure-ai-search">手順 2: データ ソースとして Azure AI Search を設定する</h3>
<p>プロジェクトの <code>src/prompts/chat/config.json</code> を開き、<code>completion</code> ブロック内に <code>data_sources</code> を追加します。</p>
<pre><code class="language-json">&quot;data_sources&quot;: [
    {
        &quot;type&quot;: &quot;azure_search&quot;,
        &quot;parameters&quot;: {
            &quot;endpoint&quot;: &quot;$searchEndpoint&quot;,
            &quot;index_name&quot;: &quot;$indexName&quot;,
            &quot;authentication&quot;: {
                &quot;type&quot;: &quot;api_key&quot;,
                &quot;key&quot;: &quot;$searchApiKey&quot;
            },
            &quot;query_type&quot;:&quot;vector&quot;,
            &quot;in_scope&quot;: true,
            &quot;strictness&quot;: 3,
            &quot;top_n_documents&quot;: 3,
            &quot;embedding_dependency&quot;: {
            &quot;type&quot;: &quot;deployment_name&quot;,
            &quot;deployment_name&quot;: &quot;$azureOpenAIEmbeddingDeploymentName&quot;
            }
        }
    }
]
</code></pre>
<p><code>src/prompts/chat/skprompt.txt</code> を開き、次のようにプロンプトを更新します。</p>
<pre><code>You are a career specialist named &quot;Career Genie&quot; that helps Human Resources team for finding the right candidate for the jobs. 
You are friendly and professional.
You always greet users with excitement and introduce yourself first.
You like using emojis where appropriate.
Always mention all citations in your content.
</code></pre>
<p>Visual Studio Code のターミナルを開き、プロジェクトのルートから次のスクリプトを実行します。</p>
<pre><code class="language-powershell">npm install fs
</code></pre>
<p><code>src/app/app.ts</code> を開き、<code>OpenAIModel</code> に次のパラメーターを追加します。</p>
<pre><code class="language-typescript">azureApiVersion: '2024-02-15-preview'
</code></pre>
<p><code>src/app/app.ts</code> の冒頭に次のインポートを追加します。</p>
<pre><code class="language-typescript">import fs from 'fs';
</code></pre>
<p><code>src/app/app.ts</code> で <code>ActionPlanner</code> の <code>defaultPrompt</code> を次のコード スニペットに置き換えます。</p>
<pre><code class="language-typescript">defaultPrompt: async () =&gt; {
    const template = await prompts.getPrompt('chat');
    const skprompt = fs.readFileSync(path.join(__dirname, '..', 'prompts', 'chat', 'skprompt.txt'));

    const dataSources = (template.config.completion as any)['data_sources'];

    dataSources.forEach((dataSource: any) =&gt; {
      if (dataSource.type === 'azure_search') {
        dataSource.parameters.authentication.key = config.azureSearchKey;
        dataSource.parameters.endpoint = config.azureSearchEndpoint;
        dataSource.parameters.indexName = config.indexName;
        dataSource.parameters.embedding_dependency.deployment_name =
          config.azureOpenAIEmbeddingDeploymentName;
        dataSource.parameters.role_information = `${skprompt.toString('utf-8')}`;
      }
    });

    return template;
}
</code></pre>
<p><cc-end-step lab="bta2" exercise="3" step="2" /></p>
<h3 id="3">手順 3: アプリをデバッグしてデータとチャットする</h3>
<div class="admonition pied-piper">
<p class="admonition-title">注意事項: Test Tool ではなくローカル デバッグ</p>
</div>
<p>追加した一部の高度な機能は App Test Tool では正しく表示されない場合があります。そのため、以降は Test Tool ではなく Teams 上でローカル デバッグを行います。</p>
<p>今回は Teams で Career Genie をテストしましょう。Visual Studio Code の <strong>Run and Debug</strong> タブで <strong>Debug in Teams (Edge)</strong> または <strong>Debug in Teams (Chrome)</strong> を選択してデバッグを開始します。ブラウザーで Microsoft Teams が立ち上がったら、アプリ詳細が表示されるので <strong>Add</strong> を選択しチャットを開始します。</p>
<div class="admonition tip">
<p class="admonition-title">ローカルでのテスト</p>
<p>Teams AI ライブラリの機能が Test Tool で正しく動作しない場合があるため、必ず Teams 上でローカル デバッグを行ってください。</p>
</div>
<p>質問はデータセットに関連する内容にしましょう。<code>resumes</code> フォルダー内の PDF を確認してデータを理解し、複数の要件を組み合わせた複雑な質問でカスタム エンジン エージェントを試してください。例えば:</p>
<ul>
<li>スペイン語が話せて .NET の経験が少なくとも 2 年ある候補者を提案してもらえますか？  </li>
<li>他に良い候補者はいますか？  </li>
<li>5 年以上の Python 開発経験が必要なポジションに適した候補者は？  </li>
<li>7 年以上の経験を持ち日本語が話せるシニア デベロッパー ポジションに合う候補者は？  </li>
</ul>
<p><img alt="Animation of the interaction with the Career Genie custom engine agent. The user interacts with the bot providing subsequent prompts and looking for a specific candidate based on some requirements." src="../../../../../assets/images/custom-engine-02/byod-teams.gif" /></p>
<p><cc-end-step lab="bta2" exercise="3" step="3" /></p>
<p><span style="font-size: large; font-weight: bold; color: #8d57c2;">おめでとうございます！</span></p>
<p>Azure AI Search にデータを取り込み、カスタム エンジン エージェントで活用する「ラボ BTA2」を完了しました！さらに探究したい場合は、このラボのソース コードが <a href="https://github.com/microsoft/copilot-camp/tree/main/src/custom-engine-agent/Lab02-RAG/CareerGenie" target="_blank">Copilot Developer Camp リポジトリ</a> で公開されています。</p>
<p>次は「ラボ BTA3 ‑ Powered by AI キットでユーザー エクスペリエンスを強化」へ進みましょう。<strong>Next</strong> を選択してください。</p>
<p><cc-next url="../03-powered-by-ai" /></p>
<p><img src="https://m365-visitor-stats.azurewebsites.net/copilot-camp/custom-engine/teams-ai/02-rag" /></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.integrate", "content.code.copy"], "search": "../../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="../../../../../javascripts/cc-award.js"></script>
      
        <script src="../../../../../javascripts/cc-next.js"></script>
      
        <script src="../../../../../javascripts/cc-lab-step.js"></script>
      
    
  </body>
</html>